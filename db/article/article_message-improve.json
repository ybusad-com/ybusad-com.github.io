{"code":0,"msg":"ok","data":{"article":{"authorCode":"admin","authorName":"孙天骁","classify":"技术类","content":"<p>\t\t2021年8月，本网站消息中心使用光辉号架构重构之后，支持收发图片就一直是我设想的下一个改进点。光辉号骁之屋的后端和前端架构设计是比较方便后期持续扩展的。虽然迟了一点，但是这个功能总算是上线了。</p><p class=\"ql-align-center\"><img src=\"/s/article/FuxdRyw2VD_iuVb5hpWgv0TaMQVd.jpg\"></p><p><br></p><p>\t\t使用方法也很简单，在消息输入框的上面新增了一个选择图片的小图标。可以在本地选择 jpg、png 或 gif 格式的图片。图片经过压缩和用户确认之后便可以发送给对方。</p><p>\t\t<img src=\"/s/article/FpZnPnM_t89oOCyNbKS3naMFfugw.jpg\"></p><p>\t\t此外，如果在输入框直接执行粘贴操作，系统也会判断剪贴板是否包含图片，会弹出对话框确认是否要执行上传和发送。</p><p>\t\t在移动版的骁之屋消息中心，这次也对输入框进行了优化，发送图片的选项在输入框右侧的“+”按钮内。</p><p><img src=\"/s/article/Ft3xg8B6qTYTKS_GQbgkG0nXHMVw.jpg\"></p><p>\t\t从技术角度来看，图片消息是一种比较特殊的私信消息，在储存的时候会额外储存图片的地址、尺寸等信息。前端拿到图片尺寸信息时，会根据图片的尺寸先计算出一个比较合适的缩略图尺寸（其中包含了对过长、过宽图片的裁剪处理），这样气泡列表的 DOM 高度就会被第一时间确定，会带来更好的用户体验。</p><p>\t\t本次的开发测试因为时间相对仓促，如果大家在使用过程中遇到什么问题，请及时反馈给我。</p><p><br></p><p>\t\t还可以看看：<a href=\"/a/splendor-message.htm\" target=\"_blank\">《上线：光辉号骁之屋消息系统》</a></p>","createTime":"2023-07-24 21:53:50","customCoverKey":"","id":336,"isGood":false,"isTop":false,"publicState":0,"replyCount":3,"state":0,"tags":["光辉号"],"title":"消息中心支持发送图片了~","urlCode":"message-improve","viewCount":87,"viewGroup":-1,"authPassed":true},"author":{"exists":true,"name":"孙天骁","code":"admin","alias":"stx","description":"一个内心丰富的人","homepageUrl":"/u/stx","group":5,"groupName":"站长","isLocked":false,"gender":1,"avatarUrl":"/s/user/FufL-vSFO5eM1we1mxdfYHKH9tfK.jpg","realName":"孙天骁","refBaike":"","isManager":true,"isMe":true,"isLover":false,"introduction":"","joinTime":"2015-02-11 21:45:00"}}}