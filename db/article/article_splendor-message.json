{"code":0,"msg":"ok","data":{"article":{"authorCode":"admin","authorName":"孙天骁","classify":"技术类","content":"<p class=\"ql-align-justify\">\t<span style=\"color:rgb(102, 102, 102);\">骁之屋的消息系统是从2015年夏季开始建设的。初代的消息系统即实现了站内信和系统通知的功能。上一版的消息系统是2018年夏季上线的，至今已经过去了三年有余。现在，我终于可以介绍基于光辉号架构下的新版消息系统了！</span></p><p class=\"ql-align-center\"><img src=\"/article/404cdfe89d4fafa4e1.jpg\"></p><p class=\"ql-align-center\"><br></p><p class=\"ql-align-justify\">\t<span style=\"color:rgb(102, 102, 102);\">新版消息系统的设计更接近于微信的设计。用户默认会有一个来自“骁之屋”的对话窗口。用于接收系统通知和公告消息等。无法向该窗口发送消息。</span></p><p class=\"ql-align-justify\">\t</p><p class=\"ql-align-justify\">\t<span style=\"color:rgb(102, 102, 102);\">在文章/随记/骁吧等评论区被别人产生回复或“@”提及后，会在“骁之屋”对话窗口中参数通知。</span></p><p class=\"ql-align-center\"><img src=\"/article/2ff6ef835d7ccaf576.jpg\"></p><p class=\"ql-align-justify\"><br></p><p class=\"ql-align-justify\">\t<span style=\"color:rgb(102, 102, 102);\">在光辉号架构下的文章系统/随记系统下，产生的回复等消息，现可以实时推送到消息中心。在骁吧等场景下暂不支持该功能，消息会在刷新页面后获取。</span></p><p class=\"ql-align-justify\">\t</p><p class=\"ql-align-justify\">\t<span style=\"color:rgb(102, 102, 102);\">当用户处于在线状态（消息中心页面开启时），会实时收到来自其他人的消息。左侧的对话列表会默认展示过去一年内有过对话的用户。如果想与未在列表中的用户对话，可以使用左上角的搜索用户功能。</span></p><p class=\"ql-align-justify\">\t</p><p class=\"ql-align-center\"><img src=\"/article/8bbf7ed1f5a909ace3.jpg\"></p><p class=\"ql-align-center\"><br></p><p class=\"ql-align-center\"><img src=\"/article/e736c12d3bfdb2c49b.jpg\"></p><p class=\"ql-align-center\"><img src=\"/article/9eec81acc3e0041f2d.jpg\"></p><p class=\"ql-align-center\"><img src=\"/article/b24c856e527f0465be.jpg\"></p><p class=\"ql-align-center\"><br></p><p class=\"ql-align-justify\">\t<span style=\"color:rgb(102, 102, 102);\">通过消息中心向其他用户发送的消息，如果对方的消息中心在线，则会实时收取。若否，会在对方骁之屋右上角头像处产生新消息提示，当对方查看骁之屋页面时会收取。对方进入消息中心后，即可以回复你的消息。</span></p><p class=\"ql-align-justify\"><br></p><p class=\"ql-align-justify\"><img src=\"/article/59889a96698efc1fa4.jpg\"></p><p class=\"ql-align-justify\">\t</p><p class=\"ql-align-justify\">\t<span style=\"color:rgb(102, 102, 102);\">骁之屋也提供了适配手机端网页版本的消息中心。手机登录骁之屋即可使用。</span></p><p class=\"ql-align-justify\">\t</p><p class=\"ql-align-center\"><span style=\"color:rgb(102, 102, 102);\"><img src=\"/article/fe907f1c437cabf9d6.jpg\"></span></p><p class=\"ql-align-justify\"><br></p><p class=\"ql-align-justify\">\t<span style=\"color:rgb(102, 102, 102);\">以上就是骁之屋消息中心的基本功能。光辉号骁之屋的消息收发逻辑是在 Node 中间层完成的，因此可以和骁之屋的其他功能有更紧密的联系。光辉号骁之屋消息中心照前代做出了众多利于体验的改进。例如掉线重连逻辑。光辉号骁之屋消息中心在与服务器失去连接时，会自动尝试重新连接。这次也考虑到了多终端情况下的消息同步问题。即便同一个账号打开多个消息中心页面，它们的消息收发状态也能流畅地在多页面之间同步。</span></p><p class=\"ql-align-justify\">\t</p><p class=\"ql-align-justify\">\t<span style=\"color:rgb(102, 102, 102);\">从技术上来讲，消息中心的 WebSocket 服务现在列于一个独立的子域名下。也是通过外层的 Nginx 实现的反向代理和 https 的支持。其未来仍有不错的改进空间。比如支持收发图片（这个从技术上说已经不是难事），以及接入 Chrome 桌面通知等。作为一个优秀的自建个人网站，消息中心的优良设计会拉进我们彼此的距离。</span></p><p class=\"ql-align-justify\">\t</p><p class=\"ql-align-justify\">\t<span style=\"color:rgb(102, 102, 102);\">欢迎大家即刻前往骁之屋体验吧。如果有 bug 或者意见反馈，可以在消息中心向我“孙天骁”发送消息，也可以通过骁吧和微信等渠道反馈给我。</span></p><p><br></p><p class=\"ql-align-center\"><a href=\"/v2/message?startChat=admin\" target=\"_blank\">! 点这里快速给我发消息 !</a></p>","createTime":"2021-08-31 21:00:19","customCoverKey":"","id":300,"isGood":true,"isTop":false,"publicState":0,"replyCount":0,"state":0,"tags":["光辉号"],"title":"上线：光辉号骁之屋消息系统","urlCode":"splendor-message","viewCount":241,"viewGroup":-1,"authPassed":true},"author":{"exists":true,"name":"孙天骁","code":"admin","alias":"stx","description":"一个内心丰富的人","homepageUrl":"/u/stx","group":5,"groupName":"站长","isLocked":false,"gender":1,"avatarUrl":"/s/user/FufL-vSFO5eM1we1mxdfYHKH9tfK.jpg","realName":"孙天骁","refBaike":"","isManager":true,"isMe":true,"isLover":false,"introduction":"","joinTime":"2015-02-11 21:45:00"}}}