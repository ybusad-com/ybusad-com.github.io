{"barInfo":{"barName":"骁","description":"开放自由的类贴吧式留言板","isMainBar":true,"isPublic":true},"list":[{"author":"孙天骁","authorCode":"admin","content":"<p>这段代码是以前高中的时候，网站后端还是ASP.NET VB时写的</p><p>以现在的眼光来看，当然是纰漏百出</p><p>但权当考古</p><br><pre spellcheck=\"false\">&lt;%@&nbsp;Page&nbsp;Language=\"VB\"&nbsp;ValidateRequest=\"false\"&nbsp;%&gt;\n\n\n&lt;script&nbsp;runat=\"server\"&gt;\n\n\n&nbsp;&nbsp;&nbsp;&nbsp;Protected&nbsp;Sub&nbsp;Page_Load(ByVal&nbsp;sender&nbsp;As&nbsp;Object,&nbsp;ByVal&nbsp;e&nbsp;As&nbsp;System.EventArgs)\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Dim&nbsp;sj&nbsp;As&nbsp;String&nbsp;=&nbsp;\"\"\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'新版随记系统&nbsp;开发日期2014/8/22\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'首先测试参数是否有效\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Try\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;If&nbsp;Val(Request.QueryString(\"pwd\"))&nbsp;&lt;&gt;&nbsp;72196&nbsp;Then&nbsp;Throw&nbsp;New&nbsp;Exception(\"参数无效！\")\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;If&nbsp;Request.QueryString(\"content\")&nbsp;Is&nbsp;Nothing&nbsp;Then&nbsp;Throw&nbsp;New&nbsp;Exception(\"参数无效！\")\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;If&nbsp;Request.QueryString(\"time\")&nbsp;=&nbsp;Nothing&nbsp;Then&nbsp;Throw&nbsp;New&nbsp;Exception(\"参数无效！\")\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;If&nbsp;Request.QueryString(\"content\").Length&nbsp;&gt;&nbsp;150&nbsp;Then&nbsp;Throw&nbsp;New&nbsp;Exception(\"字数太多！\")\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;If&nbsp;xzwtools.T.RemoveJ(Request.QueryString(\"content\").Trim)&nbsp;=&nbsp;\"\"&nbsp;Then&nbsp;Throw&nbsp;New&nbsp;Exception(\"没有内容！\")\n\n\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'先判断时间是否合法，不合法报错好了，不采用服务器的时间了-&nbsp;-\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Dim&nbsp;t_sj&nbsp;As&nbsp;String&nbsp;=&nbsp;Request.QueryString(\"time\")\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Dim&nbsp;t_year&nbsp;As&nbsp;String&nbsp;=&nbsp;Val(t_sj).ToString\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Dim&nbsp;t_month&nbsp;As&nbsp;String&nbsp;=&nbsp;Val(Mid(t_sj,&nbsp;InStr(t_sj,&nbsp;\"年\")&nbsp;+&nbsp;1)).ToString\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Dim&nbsp;t_day&nbsp;As&nbsp;String&nbsp;=&nbsp;Val(Mid(t_sj,&nbsp;InStr(t_sj,&nbsp;\"月\")&nbsp;+&nbsp;1)).ToString\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Dim&nbsp;t_hour&nbsp;As&nbsp;String&nbsp;=&nbsp;Val(Mid(t_sj,&nbsp;InStr(t_sj,&nbsp;\"日\")&nbsp;+&nbsp;1)).ToString\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Dim&nbsp;t_minute&nbsp;As&nbsp;String&nbsp;=&nbsp;xzwtools.T.b0(Val(Mid(t_sj,&nbsp;InStr(t_sj,&nbsp;\"时\")&nbsp;+&nbsp;1)).ToString)\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Dim&nbsp;t_second&nbsp;As&nbsp;String&nbsp;=&nbsp;xzwtools.T.b0(Val(Mid(t_sj,&nbsp;InStr(t_sj,&nbsp;\"分\")&nbsp;+&nbsp;1)).ToString)\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'If&nbsp;Now.Hour&nbsp;&gt;&nbsp;12&nbsp;Then&nbsp;t_hour&nbsp;+=&nbsp;12\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'Dim&nbsp;d&nbsp;As&nbsp;New&nbsp;Date(Val(t_year),&nbsp;Val(t_month),&nbsp;Val(t_day),&nbsp;Val(t_hour),&nbsp;Val(t_minute),&nbsp;Val(t_second))\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'把防止重复的代码移到客户端判断-&nbsp;-啊，不行，客户端判断没意义的-&nbsp;-\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sj&nbsp;=&nbsp;t_year&nbsp;&amp;&nbsp;\"/\"&nbsp;&amp;&nbsp;t_month&nbsp;&amp;&nbsp;\"/\"&nbsp;&amp;&nbsp;t_day&nbsp;&amp;&nbsp;\"&nbsp;\"&nbsp;&amp;&nbsp;t_hour&nbsp;&amp;&nbsp;\":\"&nbsp;&amp;&nbsp;t_minute&nbsp;&amp;&nbsp;\":\"&nbsp;&amp;&nbsp;t_second\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Catch&nbsp;ex&nbsp;As&nbsp;Exception\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Response.Write(ex.Message)\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Exit&nbsp;Sub\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;End&nbsp;Try\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Dim&nbsp;content&nbsp;As&nbsp;String&nbsp;=&nbsp;Request.QueryString(\"content\")\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Dim&nbsp;place&nbsp;As&nbsp;String&nbsp;=&nbsp;Request.QueryString(\"place\")\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Dim&nbsp;pub&nbsp;As&nbsp;String&nbsp;=&nbsp;Request.QueryString(\"pub\")\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Dim&nbsp;t_from&nbsp;As&nbsp;String&nbsp;=&nbsp;Request.QueryString(\"from\")\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;If&nbsp;pub&nbsp;=&nbsp;Nothing&nbsp;Then&nbsp;pub&nbsp;=&nbsp;\"True\"\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Dim&nbsp;wf&nbsp;As&nbsp;String&nbsp;=&nbsp;Request.QueryString(\"wf\")\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;If&nbsp;wf&nbsp;=&nbsp;Nothing&nbsp;Then&nbsp;wf&nbsp;=&nbsp;\"False\"\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;If&nbsp;t_from&nbsp;=&nbsp;Nothing&nbsp;Then&nbsp;t_from&nbsp;=&nbsp;\"Android客户端\"\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Dim&nbsp;jd&nbsp;As&nbsp;String&nbsp;=&nbsp;Request.QueryString(\"jd\")\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Dim&nbsp;wd&nbsp;As&nbsp;String&nbsp;=&nbsp;Request.QueryString(\"wd\")\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;If&nbsp;Val(wd)&nbsp;=&nbsp;0&nbsp;Then&nbsp;jd&nbsp;=&nbsp;\"0\"&nbsp;:&nbsp;wd&nbsp;=&nbsp;\"0\"\n\n\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Dim&nbsp;connString&nbsp;As&nbsp;String&nbsp;=&nbsp;\"Provider=Microsoft.Jet.OLEDB.4.0;Data&nbsp;Source=\"&nbsp;&amp;&nbsp;Request.PhysicalApplicationPath&nbsp;&amp;&nbsp;\"essay\\data.mdb;Persist&nbsp;Security&nbsp;Info=False\"\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Dim&nbsp;connection&nbsp;As&nbsp;New&nbsp;System.Data.OleDb.OleDbConnection\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;connection.ConnectionString&nbsp;=&nbsp;connString\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Dim&nbsp;sql&nbsp;As&nbsp;String&nbsp;=&nbsp;\"select&nbsp;*&nbsp;from&nbsp;list&nbsp;order&nbsp;by&nbsp;ID&nbsp;desc\"\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Try\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;connection.Open()\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Dim&nbsp;command&nbsp;As&nbsp;New&nbsp;System.Data.OleDb.OleDbCommand(sql,&nbsp;connection)\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Dim&nbsp;dataReader&nbsp;As&nbsp;System.Data.OleDb.OleDbDataReader&nbsp;=&nbsp;command.ExecuteReader\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;dataReader.Read()\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Dim&nbsp;n&nbsp;As&nbsp;Integer&nbsp;=&nbsp;1\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Dim&nbsp;d&nbsp;As&nbsp;Date&nbsp;=&nbsp;dataReader(\"时间\")\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;If&nbsp;Not&nbsp;(d.Year&nbsp;=&nbsp;Now.Year&nbsp;And&nbsp;d.Month&nbsp;=&nbsp;Now.Month&nbsp;And&nbsp;d.Day&nbsp;=&nbsp;Now.Day)&nbsp;Then\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;n&nbsp;=&nbsp;0\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;End&nbsp;If\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;If&nbsp;dataReader(\"内容\")&nbsp;=&nbsp;content&nbsp;Then\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Throw&nbsp;New&nbsp;Exception(\"发布成功，但由于去重，无法提供随记条数。\")\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Else\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;If&nbsp;n&nbsp;=&nbsp;0&nbsp;Then&nbsp;GoTo&nbsp;1\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;While&nbsp;dataReader.Read\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;d&nbsp;=&nbsp;dataReader(\"时间\")\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;If&nbsp;d.Year&nbsp;=&nbsp;Now.Year&nbsp;And&nbsp;d.Month&nbsp;=&nbsp;Now.Month&nbsp;And&nbsp;d.Day&nbsp;=&nbsp;Now.Day&nbsp;Then\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;n&nbsp;+=&nbsp;1\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Else\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Exit&nbsp;While\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;End&nbsp;If\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;End&nbsp;While\n1:\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;dataReader.Close()\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sql&nbsp;=&nbsp;\"insert&nbsp;into&nbsp;list(内容,地点,来源,时间,公开,你,经度,纬度)values('{0}','{1}','{2}','{3}',{4},{5},{6},{7})\"\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sql&nbsp;=&nbsp;String.Format(sql,&nbsp;content,&nbsp;Trim(place),&nbsp;t_from,&nbsp;sj,&nbsp;pub,&nbsp;wf,&nbsp;jd,&nbsp;wd)\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;command.CommandText&nbsp;=&nbsp;sql\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;If&nbsp;command.ExecuteNonQuery&nbsp;&gt;&nbsp;0&nbsp;Then\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Response.Write(\"发布成功&lt;br&gt;今天第\"&nbsp;&amp;&nbsp;(n&nbsp;+&nbsp;1).ToString&nbsp;&amp;&nbsp;\"条随记\")\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;extra(content,&nbsp;sj,&nbsp;jd,&nbsp;wd)\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Else\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Response.Write(\"发布失败，请重试\")\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;End&nbsp;If\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;End&nbsp;If\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\n\n\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Catch&nbsp;ex&nbsp;As&nbsp;Exception\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Response.Write(ex.Message)\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Finally\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;connection.Close()\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;End&nbsp;Try\n\n\n&nbsp;&nbsp;&nbsp;&nbsp;End&nbsp;Sub\n&nbsp;&nbsp;&nbsp;&nbsp;\n&nbsp;&nbsp;&nbsp;&nbsp;'''&nbsp;&lt;summary&gt;\n&nbsp;&nbsp;&nbsp;&nbsp;'''&nbsp;这里是额外代码\n&nbsp;&nbsp;&nbsp;&nbsp;'''&nbsp;&lt;/summary&gt;\n&nbsp;&nbsp;&nbsp;&nbsp;'''&nbsp;&lt;param&nbsp;name=\"content\"&gt;随记内容&lt;/param&gt;\n&nbsp;&nbsp;&nbsp;&nbsp;'''&nbsp;&lt;param&nbsp;name=\"time\"&gt;随记时间&lt;/param&gt;\n&nbsp;&nbsp;&nbsp;&nbsp;'''&nbsp;&lt;param&nbsp;name=\"jd\"&gt;随记经度&lt;/param&gt;\n&nbsp;&nbsp;&nbsp;&nbsp;'''&nbsp;&lt;param&nbsp;name=\"wd\"&gt;随记纬度&lt;/param&gt;\n&nbsp;&nbsp;&nbsp;&nbsp;'''&nbsp;&lt;remarks&gt;&lt;/remarks&gt;\n&nbsp;&nbsp;&nbsp;&nbsp;Protected&nbsp;Sub&nbsp;extra(ByVal&nbsp;content&nbsp;As&nbsp;String,&nbsp;ByVal&nbsp;time&nbsp;As&nbsp;String,&nbsp;ByVal&nbsp;jd&nbsp;As&nbsp;String,&nbsp;ByVal&nbsp;wd&nbsp;As&nbsp;String)\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'//这里附加额外代码\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;If&nbsp;jd&nbsp;&lt;&gt;&nbsp;\"0\"&nbsp;Then\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'如果经纬度填了该如何...\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;End&nbsp;If\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;If&nbsp;content.StartsWith(\"#公告#\")&nbsp;Then\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;xzwtools.T.SaveFile(Request.PhysicalApplicationPath&nbsp;&amp;&nbsp;\"home\\notice.txt\",&nbsp;time&nbsp;&amp;&nbsp;vbCrLf&nbsp;&amp;&nbsp;content.Replace(\"#公告#\",&nbsp;\"\"))\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;End&nbsp;If\n&nbsp;&nbsp;&nbsp;&nbsp;End&nbsp;Sub\n&nbsp;&nbsp;&nbsp;&nbsp;\n&lt;/script&gt;\n\n</pre> ","floor":1,"pid":0,"postTime":"2021-05-03 21:17:49","replyCount":0,"signKey":"","source":"","sourceUrl":"","tid":3142},{"author":"孙天骁","authorCode":"admin","content":"<p><strong style=\"color: rgb(230, 0, 0);\">光辉号骁之屋随记系统 即将登场。</strong></p> ","floor":2,"pid":8872,"postTime":"2021-05-03 21:29:22","replyCount":0,"signKey":"","source":"","tid":3142},{"author":"孙天骁","authorCode":"admin","content":"<p>7年后，使用Go语言实现的随记添加逻辑十分的工整和精美。</p> ","floor":3,"pid":8873,"postTime":"2021-05-04 00:01:11","replyCount":0,"signKey":"","source":"","tid":3142}],"pageInfo":{"total":3,"pageSize":30,"current":1},"threadInfo":{"author":"孙天骁","authorCode":"admin","classifyName":"技术","goodClassifyName":"","id":3142,"isGood":true,"isPicture":false,"isRepost":false,"postTime":"2021-05-03 21:17:49","replyCount":2,"title":"上古时期随记添加后端代码","topState":0},"tid":3142,"total":3,"totalPages":1,"viewHost":false,"users":{"admin":{"exists":true,"name":"孙天骁","code":"admin","alias":"stx","description":"一个内心丰富的人","homepageUrl":"/u/stx","group":5,"groupName":"站长","isLocked":false,"gender":1,"avatarUrl":"/s/user/FufL-vSFO5eM1we1mxdfYHKH9tfK.jpg","realName":"孙天骁","refBaike":"","isManager":true,"isMe":true,"isLover":false,"introduction":"","joinTime":"2015-02-11 21:45:00"}},"needVerify":true}